<div class="container">
  <header>
    GAUTI
    <small>Fatura de Hospedagem</small>
  </header>

  <div class="loader" *ngIf="loading"></div>

  <div class="main" *ngIf="invoice">
    <div class="info">
      <div class="row">
        <div class="col">
          <h3>Fatura de {{ getMonthYear(invoice) }}</h3>
        </div>
        <div class="col text-right">
          Vencimento: <strong class="nowrap">{{ getDueDate(invoice) }}</strong><br />
          <ng-container *ngIf="invoice.closed">
            Valor total: <strong class="nowrap">R$ {{ invoice.amount | number:'1.2-2' }}</strong>
          </ng-container>
          <small class="text-muted" *ngIf="!invoice.closed">
            Valor parcial: R$ {{ amountSum | number:'1.2-2' }}
          </small>
        </div>
      </div>
    </div>

    <table class="table table-striped table-sm" *ngIf="invoice.postings">
      <thead>
        <tr>
          <th>Data</th>
          <th>Descrição</th>
          <th class="text-right">Valor</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let posting of invoice.postings">
          <td>{{ posting.createdAt | date: 'dd/MM' }}</td>
          <td>{{ posting.description }}</td>
          <td class="text-right nowrap">R$ {{ posting.amount | number:'1.2-2' }}</td>
        </tr>
      </tbody>
    </table>

    <div class="text-center">
      <div *ngIf="!invoice.closed" class="alert alert-warning">Esta fatura ainda não está fechada!</div>
      <div *ngIf="invoice.paid && !loading" class="alert alert-success">Esta fatura está paga!</div>
      <a *ngIf="invoice.closed && !invoice.paid && !loading"
        class="btn btn-lg btn-success mb-3"
        href="javascript:void(0);"
        (click)="pay(invoice.paymentCode)"
      >Pagar agora!</a>

      <div *ngIf="!showHelp">
        <small>
          <a href="javascript:void(0);" (click)="showHelp = !showHelp">Tenho um problema!</a>
        </small>
      </div>
      <div *ngIf="showHelp" class="alert alert-info help">
        <small>
          Em caso de problemas com o pagamento ou dúvidas sobre a fatura, envie uma mensagem para
          <strong><a target="_blank" href="mailto:financeiro@gauti.com.br">financeiro@gauti.com.br</a></strong>.
        </small>
      </div>
    </div>
  </div>
</div>